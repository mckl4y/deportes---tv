<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deportes App</title>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; margin: 0; padding: 10px; padding-bottom: 80px; }
        .tab-bar { position: fixed; bottom: 0; left: 0; right: 0; background: #111; display: flex; justify-content: space-around; padding: 15px; border-top: 1px solid #333; }
        .btn { background: #e50914; color: white; padding: 8px; border-radius: 4px; text-decoration: none; font-size: 12px; font-weight: bold; }
        .event { background: #1a1a1a; margin: 10px 0; padding: 15px; border-radius: 8px; display: flex; align-items: center; justify-content: space-between; border-left: 4px solid #e50914; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .card { background: #1a1a1a; padding: 10px; border-radius: 8px; text-align: center; }
        .card img { width: 50px; height: 50px; object-fit: contain; }
        .hidden { display: none; }
        h2 { color: #e50914; border-bottom: 1px solid #333; }
    </style>
</head>
<body>

    <div id="view-agenda">
        <h2>ðŸ“… AGENDA</h2>
        <div id="list-agenda">Cargando...</div>
    </div>

    <div id="view-tv" class="hidden">
        <h2>ðŸ“º CANALES</h2>
        <div id="list-tv" class="grid">Cargando...</div>
    </div>

    <div class="tab-bar">
        <div onclick="show('agenda')" style="cursor:pointer">ðŸ“… Agenda</div>
        <div onclick="show('tv')" style="cursor:pointer">ðŸ“º Canales</div>
    </div>

<script>
    // NUEVO PROXY MÃS ESTABLE
    const proxy = "https://corsproxy.io/?";
    const apiTV = "https://cdn-live.tv/api/v1/channels";
    const apiEvents = "https://cdn-live.tv/api/events";

    function show(view) {
        document.getElementById('view-agenda').className = view === 'agenda' ? '' : 'hidden';
        document.getElementById('view-tv').className = view === 'tv' ? '' : 'hidden';
    }

    async function getData() {
        // Cargar Canales
        try {
            const res = await fetch(proxy + encodeURIComponent(apiTV));
            const data = await res.json();
            document.getElementById('list-tv').innerHTML = data.channels.map(ch => `
                <div class="card">
                    <img src="${ch.image}"><br>
                    <small>${ch.name}</small><br><br>
                    <a href="vlc://${ch.url}" class="btn">VLC</a>
                </div>
            `).join('');
        } catch (e) { document.getElementById('list-tv').innerHTML = "Error TV. Reintenta."; }

        // Cargar Agenda
        try {
            const res = await fetch(proxy + encodeURIComponent(apiEvents));
            const data = await res.json();
            const sports = data["cdn-live-tv"];
            let html = "";
            ["Soccer", "NBA", "NFL", "NHL"].forEach(s => {
                if (sports[s]) {
                    html += `<h3>${s}</h3>`;
                    sports[s].forEach(ev => {
                        html += `
                        <div class="event">
                            <div><strong>${ev.homeTeam} vs ${ev.awayTeam}</strong><br><small>${ev.time}</small></div>
                            <a href="${ev.channels[0].url}" target="_blank" class="btn">VER</a>
                        </div>`;
                    });
                }
            });
            document.getElementById('list-agenda').innerHTML = html || "No hay eventos.";
        } catch (e) { document.getElementById('list-agenda').innerHTML = "Error Agenda. Reintenta."; }
    }

    getData();
</script>
</body>
</html>
