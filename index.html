<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMANTES DEL F‚öΩTBOL</title>
    <style>
        :root { 
            --accent: #00ff41; --bg: #060606; --card-bg: #111111;
            --text-dim: #888;
        }
        
        body { 
            font-family: 'Inter', -apple-system, sans-serif; background: var(--bg); 
            color: white; margin: 0; padding-bottom: 100px;
        }

        /* Header con Branding */
        header { padding: 40px 20px 20px; text-align: center; }
        header h1 { font-size: 24px; font-weight: 900; margin: 0; letter-spacing: 1px; text-transform: uppercase; }
        .ball { color: var(--accent); }

        /* Navegaci√≥n por Categor√≠as (Din√°mica) */
        .category-nav {
            display: flex; gap: 10px; overflow-x: auto; padding: 10px 20px;
            position: sticky; top: 0; background: rgba(6,6,6,0.9); backdrop-filter: blur(15px);
            z-index: 100; border-bottom: 1px solid #1a1a1a;
        }
        .category-nav::-webkit-scrollbar { display: none; }
        .cat-btn {
            background: #1a1a1a; border: none; color: white; padding: 8px 18px; 
            border-radius: 8px; font-size: 13px; font-weight: 600; white-space: nowrap; cursor: pointer;
        }
        .cat-btn.active { background: white; color: black; }

        .container { padding: 20px; max-width: 800px; margin: auto; }

        /* Tarjeta de Evento Minimalista */
        .event-card { 
            background: var(--card-bg); border-radius: 12px; padding: 20px; margin-bottom: 15px;
            border: 1px solid #1a1a1a;
        }
        .event-top { display: flex; justify-content: space-between; font-size: 11px; color: var(--text-dim); margin-bottom: 15px; font-weight: 700; }
        .live-tag { color: var(--accent); display: flex; align-items: center; gap: 4px; }
        .live-dot { height: 6px; width: 6px; background: var(--accent); border-radius: 50%; box-shadow: 0 0 8px var(--accent); }

        .event-main { display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; gap: 15px; text-align: center; }
        .team img { width: 45px; height: 45px; object-fit: contain; margin-bottom: 8px; }
        .team-name { font-size: 14px; font-weight: 600; display: block; }
        .score-center { font-size: 22px; font-weight: 900; font-family: monospace; }

        .event-details { margin-top: 15px; font-size: 11px; color: var(--text-dim); text-align: center; border-top: 1px solid #1a1a1a; padding-top: 12px; }

        /* Desplegable de Enlaces */
        .link-dropdown { margin-top: 15px; }
        .link-toggle { 
            width: 100%; padding: 10px; background: #1a1a1a; border-radius: 8px; 
            border: 1px solid #222; color: white; font-size: 12px; font-weight: bold; cursor: pointer;
            display: flex; justify-content: space-between; align-items: center;
        }
        .link-list { display: none; padding-top: 10px; flex-direction: column; gap: 8px; }
        .link-list.show { display: flex; }
        .link-item { 
            background: #222; color: white; text-decoration: none; padding: 12px; 
            border-radius: 8px; font-size: 12px; font-weight: 600; text-align: center;
        }

        /* Tab Bar Inferior */
        .tab-bar { position: fixed; bottom: 0; width: 100%; background: #000; display: flex; justify-content: space-around; padding: 15px 0 30px; border-top: 1px solid #1a1a1a; }
        .tab-btn { background: none; border: none; color: var(--text-dim); font-weight: bold; cursor: pointer; }
        .tab-btn.active { color: white; }

        .hidden { display: none; }
    </style>
</head>
<body>

<header>
    <h1>AMANTES DEL F<span class="ball">‚öΩ</span>TBOL</h1>
</header>

<div id="tab-agenda">
    <div class="category-nav" id="cat-nav">
        </div>
    <div class="container" id="agenda-content">
        <p style="text-align:center; color: #555;">Sincronizando con la API...</p>
    </div>
</div>

<div id="tab-tv" class="hidden">
    <div class="container" id="tv-content">
        </div>
</div>

<nav class="tab-bar">
    <button class="tab-btn active" onclick="switchTab('agenda')">EVENTOS</button>
    <button class="tab-btn" onclick="switchTab('tv')">CANALES TV</button>
</nav>

<script>
    const PROXY = "https://api.allorigins.win/get?url=";
    const API_SPORTS = "https://api.cdn-live.tv/api/v1/events/sports/?user=cdnlivetv&plan=free";
    const API_CHANNELS = "https://api.cdn-live.tv/api/v1/channels/?user=cdnlivetv&plan=free";

    let db = { sports: {}, channels: [] };
    let currentCat = '';

    async function init() {
        try {
            const [sRes, cRes] = await Promise.all([
                fetch(PROXY + encodeURIComponent(API_SPORTS)).then(r => r.json()),
                fetch(PROXY + encodeURIComponent(API_CHANNELS)).then(r => r.json())
            ]);
            
            // Extraer datos
            const sportsRaw = JSON.parse(sRes.contents);
            db.sports = sportsRaw['cdn-live-tv'] || sportsRaw;
            db.channels = JSON.parse(cRes.contents).channels || [];

            // Generar Men√∫ de Categor√≠as din√°micamente desde la API
            const categories = Object.keys(db.sports);
            const nav = document.getElementById('cat-nav');
            
            if (categories.length > 0) {
                currentCat = categories[0]; // Selecciona la primera por defecto (ej. Soccer)
                nav.innerHTML = categories.map(cat => `
                    <button class="cat-btn ${cat === currentCat ? 'active' : ''}" onclick="setCat('${cat}')">
                        ${cat}
                    </button>
                `).join('');
            }
            
            render();
        } catch (e) {
            document.getElementById('agenda-content').innerHTML = "Error de conexi√≥n con la API.";
        }
    }

    function setCat(cat) {
        currentCat = cat;
        document.querySelectorAll('.cat-btn').forEach(btn => {
            btn.classList.toggle('active', btn.innerText === cat);
        });
        render();
    }

    function render() {
        // Renderizar Eventos
        const events = db.sports[currentCat] || [];
        let html = "";
        
        events.forEach(e => {
            if (e.status.toLowerCase() === 'finished') return;

            const isLive = e.status.toLowerCase() === 'live';
            
            html += `
            <div class="event-card">
                <div class="event-top">
                    <span class="${isLive ? 'live-tag' : ''}">
                        ${isLive ? '<div class="live-dot"></div> EN VIVO' : e.status}
                    </span>
                    <span>${e.tournament}</span>
                </div>
                <div class="event-main">
                    <div class="team">
                        <img src="${e.homeTeamIMG}" onerror="this.src='https://via.placeholder.com/50?text=T1'">
                        <span class="team-name">${e.homeTeam}</span>
                    </div>
                    <div class="score-center">${isLive ? (e.score || '0-0') : e.time}</div>
                    <div class="team">
                        <img src="${e.awayTeamIMG}" onerror="this.src='https://via.placeholder.com/50?text=T2'">
                        <span class="team-name">${e.awayTeam}</span>
                    </div>
                </div>
                <div class="event-details">
                    üìç ${e.stadium || 'Estadio TBA'} | ${e.date || 'Hoy'}
                </div>
                <div class="link-dropdown">
                    <button class="link-toggle" onclick="this.nextElementSibling.classList.toggle('show')">
                        OPCIONES DE CANALES <span>‚ñº</span>
                    </button>
                    <div class="link-list">
                        ${e.channels ? e.channels.map(ch => `
                            <a href="${ch.url}" target="_blank" class="link-item">üì∫ ${ch.channel_name}</a>
                        `).join('') : '<p style="font-size:10px; text-align:center;">No hay enlaces disponibles</p>'}
                    </div>
                </div>
            </div>`;
        });
        
        document.getElementById('agenda-content').innerHTML = html || `<p style="text-align:center; padding:40px; color:#555;">No hay eventos en ${currentCat}</p>`;
        
        // Renderizar Canales TV (Simplificado)
        document.getElementById('tv-content').innerHTML = `
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                ${db.channels.slice(0, 50).map(c => `
                    <div style="background:#111; padding:15px; border-radius:10px; text-align:center;">
                        <img src="${c.image}" style="height:40px; margin-bottom:10px;">
                        <a href="${c.url}" target="_blank" style="color:var(--accent); text-decoration:none; font-size:12px; font-weight:bold; display:block;">VER CANAL</a>
                    </div>
                `).join('')}
            </div>
        `;
    }

    function switchTab(tab) {
        document.getElementById('tab-agenda').classList.toggle('hidden', tab !== 'agenda');
        document.getElementById('tab-tv').classList.toggle('hidden', tab !== 'tv');
        document.querySelectorAll('.tab-btn').forEach((b, i) => b.classList.toggle('active', (tab==='agenda' && i===0) || (tab==='tv' && i===1)));
    }

    init();
</script>
</body>
</html>
